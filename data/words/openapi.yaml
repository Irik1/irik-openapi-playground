openapi: 3.1.0
info:
  title: Words API
  description: API documentation for the Words service
  version: 1.0.0
servers:
  - url: http://localhost:8080
    description: Local server
  - url: https://api.dev.appewa.com/words/v1
    description: Dev server
  - url: https://api.appewa.com/words/v1
    description: Prod server
paths:
  /healthz:
    get:
      summary: Health check
      description: Check if the service is available
      responses:
        '200':
          description: Service is available
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: available
                  version:
                    type: string
                    example: 1.0.0
  /words/api/{api_version}/list:
    post:
      summary: Get words by IDs
      description: Obtains multiple words' data by a list of IDs
      parameters:
        - name: api_version
          in: path
          required: true
          description: The version of the API
          schema:
            type: string
        - name: sourceLanguage
          in: query
          description: The native language of a user
          schema:
            type: string
            minLength: 2
            maxLength: 5
            examples: ['en', 'es', 'de']
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WordsListRequest'
      responses:
        '200':
          description: A list of words
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultWrapper'
                properties:
                  result:
                    $ref: '#/components/schemas/WordsListResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /words/api/{api_version}/origin/{origin}:
    get:
      summary: Get word by origin
      description: Obtains a word's data by its origin and language
      parameters:
        - name: api_version
          in: path
          required: true
          description: The version of the API
          schema:
            type: string
        - name: origin
          in: path
          required: true
          description: The origin of the word
          schema:
            type: string
        - name: learningLanguage
          in: query
          required: true
          description: The language of the content (e.g. word)
          schema:
            type: string
            minLength: 2
            maxLength: 5
            examples: ['en', 'es', 'de']
        - name: sourceLanguage
          in: query
          description: The native language of a user
          schema:
            type: string
            minLength: 2
            maxLength: 5
            examples: ['en', 'es', 'de']
      responses:
        '200':
          description: Word data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultWrapper'
                properties:
                  result:
                    $ref: '#/components/schemas/WordData'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /words/api/{api_version}/confused-words/{origin}:
    get:
      summary: Get confused words
      description: Obtains confused words data by one word's origin and language
      parameters:
        - name: api_version
          in: path
          required: true
          description: The version of the API
          schema:
            type: string
        - name: origin
          in: path
          required: true
          description: The origin of the word
          schema:
            type: string
        - name: learningLanguage
          in: query
          required: true
          description: The language of the content (e.g. word)
          schema:
            type: string
            minLength: 2
            maxLength: 5
            examples: ['en', 'es', 'de']
        - name: sourceLanguage
          in: query
          description: The native language of a user
          schema:
            type: string
            minLength: 2
            maxLength: 5
            examples: ['en', 'es', 'de']
      responses:
        '200':
          description: Confused words data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultWrapper'
                properties:
                  result:
                    $ref: '#/components/schemas/WordsListResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /words/api/{api_version}/{word_id}:
    get:
      summary: Get word by ID
      description: Obtains a word's data by its ID
      parameters:
        - name: api_version
          in: path
          required: true
          description: The version of the API
          schema:
            type: string
        - name: word_id
          in: path
          required: true
          description: The word's ID string, translation IDs could be specified in it separated by colon, e.g. '123:456:789'
          schema:
            type: string
        - name: sourceLanguage
          in: query
          description: The native language of a user
          schema:
            type: string
            minLength: 2
            maxLength: 5
            examples: ['en', 'es', 'de']
      responses:
        '200':
          description: Word data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultWrapper'
                properties:
                  result:
                    $ref: '#/components/schemas/WordData'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /words/api/{api_version}/localized-example/metadata:
    post:
      summary: Generate localized example metadata
      description: Generates metadata for the specified example
      parameters:
        - name: api_version
          in: path
          required: true
          description: The version of the API
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LocalizedExampleMetaRequest'
      responses:
        '200':
          description: Localized example metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResultWrapper'
                properties:
                  result:
                    $ref: '#/components/schemas/LocalizedExampleMetaResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '503':
          $ref: '#/components/responses/ServiceUnavailableError'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  responses:
    BadRequestError:
      description: Bad request
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Bad request
    NotFoundError:
      description: Not Found
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Word was not found
    ServiceUnavailableError:
      description: Service unavailable
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Service sentence-analyzer is unavailable, try again later
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Internal server error
  schemas:
    ResultWrapper:
      type: object
      properties:
        result:
          description: The response from the API, which needs to be wrapped
    WordsListRequest:
      type: object
      properties:
        wordIds:
          type: array
          items:
            type: string
          description: List of word IDs
          examples: [['12345678-1234-1234-1234-123456789abc', '12345678-1234-1234-1234-123456789def']]
      required:
        - wordIds
    WordsListResponse:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/WordData'
          description: The list of words
        totalCount:
          type: integer
          description: The total number of words
          examples: [0, 15]
    WordData:
      type: object
      properties:
        _id:
          type: string
          format: uuid
          description: The unique identifier of the word
          examples: ['12345678-1234-1234-1234-123456789abc']
        nativeLanguage:
          type: string
          description: The native language of the word
          examples: ['en', 'es', 'de']
        origin:
          type: string
          description: The origin of the word
          examples: ['table', 'destroy', 'light']
        audio:
          $ref: '#/components/schemas/AudioData'
        transcription:
          type: string
          description: Phonetic transcription
          examples: ['ˈteɪbl']
        isDeleted:
          type: boolean
          description: Whether the word is deleted
          examples: [true, false]
        frequency:
          type: number
          description: Word frequency
          examples: [12.3, 1100.58]
        description:
          type: string
          description: Word description
          examples: ['A table is a piece of furniture with a flat top and one or more legs.']
        etymology:
          type: string
          description: Word etymology
          examples: ['From Middle English table, from Old French table, from Latin tabula, from Greek τάβλη, from Phoenician תַּבְלִית, from Hebrew תַּבְלִית, "flat board, plank".']
        meanings:
          type: object
          additionalProperties: true
          description: Word meanings in different languages
          examples: [{'ru': {'value': ['стол'], 'isVerified': True}}]
        translations:
          type: object
          additionalProperties: true
          description: Word translations in different languages
          examples: [{'de': {'adj': 'leicht, hell', 'noun': 'Licht', 'verb': 'leuchten'}}]
        translationList:
          type: object
          additionalProperties: true
          description: Detailed translation list
          examples: [{'de': [{'_id': '12345678-1234-1234-1234-123456789abc', 'text': 'Licht', 'pos': 'noun', 'isDefault': True, 'isSpecific': False}]}]
        examples:
          type: array
          items:
            type: string
          description: Example sentences
          examples: [["There is dinner on the table if you're hungry."]]
        localizedExamples:
          type: array
          items:
            $ref: '#/components/schemas/LocalizedExampleData'
          description: Localized example sentences
        antonyms:
          type: array
          items:
            $ref: '#/components/schemas/LinkedWordData'
          description: Antonyms of the word
        synonyms:
          type: array
          items:
            $ref: '#/components/schemas/LinkedWordData'
          description: Synonyms of the word
        formalSynonyms:
          type: array
          items:
            $ref: '#/components/schemas/LinkedWordData'
          description: Formal synonyms of the word
        informalSynonyms:
          type: array
          items:
            $ref: '#/components/schemas/LinkedWordData'
          description: Informal synonyms of the word
        confusedWords:
          $ref: '#/components/schemas/ConfusedWordsData'
    AudioData:
      type: object
      properties:
        _id:
          type: string
          format: uuid
          description: Audio file ID
          examples: ['12345678-1234-1234-1234-123456789abc']
        url:
          type: string
          description: Audio file URL
          examples: ['https://storage.appewa.com/api/v1/files/12345678-1234-1234-1234-123456789abc']
    LocalizedExampleData:
      type: object
      properties:
        _id:
          type: string
          format: uuid
          description: Example ID
          examples: ['18a36ac0-b3f7-4050-b4f2-b30ebbdbb737']
        origin:
          type: string
          description: Original example text
          examples: ["There is dinner on the table if you're hungry."]
        translations:
          type: object
          additionalProperties:
            type: string
          description: Translations of the example
          examples: [{'ru': 'Ужин на столе, если вы голодны.'}]
        wordForm:
          type: string
          description: The word form in the example
          examples: ['table']
        pos:
          type: string
          description: Part of speech
          examples: ['noun']
        start:
          type: integer
          description: Start position of the word in the example
          examples: [23]
        end:
          type: integer
          description: End position of the word in the example
          examples: [27]
        audio:
          $ref: '#/components/schemas/AudioData'
    LinkedWordData:
      type: object
      properties:
        _id:
          type: string
          format: uuid
          description: Word ID
          examples: ['12345678-1234-1234-1234-123456789abc']
        origin:
          type: string
          description: Word origin
          examples: ['table', 'destroy', 'light']
    ConfusedWordsData:
      type: object
      properties:
        linkedWords:
          type: array
          items:
            $ref: '#/components/schemas/LinkedWordData'
          description: Linked confused words
          examples: [[{'_id': 'ad8674a0-ccf2-4a2c-b10b-0d4595991327', 'origin': 'effect'}]]
        pos:
          type: string
          description: Part of speech
          examples: ['noun']
        difference:
          type: array
          items:
            type: string
          description: Differences between confused words
          examples: [["'Affect' usually describes an action or influence on something else, because it's a verb.", "'Effect' is typically the result or outcome of a change, since it's a noun."]]
        whenToUse:
          type: string
          description: When to use each word
          examples: ["Use 'affect' when you want to describe how one thing influence on another."]
    LocalizedExampleMetaRequest:
      type: object
      properties:
        origin:
          type: string
          description: The origin of the example
          examples: ["There is dinner on the table if you're hungry."]
        wordOrigin:
          type: string
          description: The target word to generate metadata for
          examples: ['table']
        sourceLanguage:
          type: string
          description: The source language of the origin
          examples: ['en', 'es', 'de']
      required:
        - origin
        - wordOrigin
        - sourceLanguage
    LocalizedExampleMetaResponse:
      type: object
      properties:
        origin:
          type: string
          description: The origin of the example
          examples: ["There is dinner on the table if you're hungry."]
        wordForm:
          type: string
          description: The word form in the example
          examples: ['table']
        pos:
          type: string
          description: Part of speech
          examples: ['noun']
        start:
          type: integer
          description: Start position of the word in the example
          examples: [23]
        end:
          type: integer
          description: End position of the word in the example
          examples: [27]
        audio:
          type: string
          description: Audio file ID
          examples: ['421fb8b4-9f5e-4f4f-aaf0-a51937d7f5f1']
        addedByScript:
          type: boolean
          description: Whether the example was added by script
          examples: [false] 